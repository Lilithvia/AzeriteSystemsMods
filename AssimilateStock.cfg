// Azerite System and Reusable SRB
// Authored by JadeOfMaar
// Ver. 2.2

// Engines
@PART:HAS[@RESOURCE[SolidFuel]]
{
	@MODULE[ModuleEngines*]
	{
		!allowShutdown = nah
		@PROPELLANT[SolidFuel]
		{
			@name = RefinedAzerite
		}
	}
	@RESOURCE[SolidFuel]
	{
		@name = RefinedAzerite
	}
}
@PART:HAS[@RESOURCE[XenonGas]]
{
	@RESOURCE[XenonGas]
	{
		@name = DilutedAzerite
		@amount /= 5
		@maxAmount /= 5
	}
}
@PART:HAS[@MODULE[ModuleEngines*]:HAS[@PROPELLANT[XenonGas]]]
{
	// 5* thrust on ion engines for same EC cost
	@MODULE[ModuleEngines*]
	{
		@PROPELLANT[XenonGas]
		{
			@name = DilutedAzerite
		}
		@PROPELLANT[ElectricCharge]
		{
			@ratio /= 5
		}
		@maxThrust *= 5
	}
}

// Converters
@PART[ISRU]
{
	@MODULE[ModuleResourceConverter],*
	{
		@INPUT_RESOURCE:HAS[#ResourceName[Ore]]
		{
			@ResourceName = Azerite
		}
	}
	!MODULE[ModuleResourceConverter]:HAS[#ConverterName[Lf+Ox]] {}
}
@PART[MiniISRU]
{
	@MODULE[ModuleResourceConverter]:HAS[#ConverterName[LiquidFuel]] // LF
	{
		@ConverterName = RefinedAzerite
		@StartActionName = Start ISRU [RefinedAzerite]
		@StopActionName = Stop ISRU [RefinedAzerite]
		@INPUT_RESOURCE:HAS[#ResourceName[Ore]]
		{
			@ResourceName = Azerite
			@Ratio = 0.45
		}
		@OUTPUT_RESOURCE
		{
			@ResourceName = RefinedAzerite
			@Ratio = 0.5
		}
	}
	@MODULE[ModuleResourceConverter]:HAS[#ConverterName[Oxidizer]] // OX
	{
		@ConverterName = DilutedAzerite
		@StartActionName = Start ISRU [DilutedAzerite]
		@StopActionName = Stop ISRU [DilutedAzerite]
		@INPUT_RESOURCE:HAS[#ResourceName[Ore]]
		{
			@ResourceName = Azerite
			@Ratio = 0.15
		}
		@OUTPUT_RESOURCE
		{
			@ResourceName = DilutedAzerite
			@Ratio = 0.15
		}
	}
	!MODULE[ModuleResourceConverter]:HAS[#ConverterName[Lf+Ox]] {} // LFO
	!MODULE[ModuleResourceConverter]:HAS[#ConverterName[MonoPropellant]]{} // MO
}

// Drills
@PART:HAS[@MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Ore]]]
{
	@MODULE[ModuleResourceHarvester]
	{
		@ResourceName = Azerite
	}
}

// Scanners
@PART[OrbitalScanner]
{
	@MODULE[ModuleResourceScanner]
	{
		@ResourceName = Azerite
	}
}
@PART[SurfaceScanner]
{
	@MODULE[ModuleResourceScanner]
	{
		@ResourceName = Azerite
	}
	@MODULE[ModuleAnalysisResource]
	{
		@ResourceName = Azerite
	}
}